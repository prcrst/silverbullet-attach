var mod=(()=>{var m=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var A=Object.prototype.hasOwnProperty;var p=(e,t)=>{for(var o in t)m(e,o,{get:t[o],enumerable:!0})},F=(e,t,o,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of C(t))!A.call(e,i)&&i!==o&&m(e,i,{get:()=>t[i],enumerable:!(r=w(t,i))||r.enumerable});return e};var M=e=>F(m({},"__esModule",{value:!0}),e);var Pe={};p(Pe,{functionMapping:()=>b});typeof Deno>"u"&&(self.Deno={args:[],build:{arch:"x86_64"},env:{get(){}}});var u=new Map,l=0;function c(e){self.postMessage(e)}self.syscall=async(e,...t)=>await new Promise((o,r)=>{l++,u.set(l,{resolve:o,reject:r}),c({type:"sys",id:l,name:e,args:t})});function f(e,t){self.addEventListener("message",o=>{(async()=>{let r=o.data;switch(r.type){case"inv":{let i=e[r.name];if(!i)throw new Error(`Function not loaded: ${r.name}`);try{let a=await Promise.resolve(i(...r.args||[]));c({type:"invr",id:r.id,result:a})}catch(a){console.error("An exception was thrown as a result of invoking function",r.name,"error:",a),c({type:"invr",id:r.id,error:a.message})}}break;case"sysr":{let i=r.id,a=u.get(i);if(!a)throw Error("Invalid request id");u.delete(i),r.error?a.reject(new Error(r.error)):a.resolve(r.result)}break}})().catch(console.error)}),c({type:"manifest",manifest:t})}function I(e){let t=atob(e),o=t.length,r=new Uint8Array(o);for(let i=0;i<o;i++)r[i]=t.charCodeAt(i);return r}function y(e){typeof e=="string"&&(e=new TextEncoder().encode(e));let t="",o=e.byteLength;for(let r=0;r<o;r++)t+=String.fromCharCode(e[r]);return btoa(t)}async function S(e,t){if(typeof e!="string"){let o=new Uint8Array(await e.arrayBuffer()),r=o.length>0?y(o):void 0;t={method:e.method,headers:Object.fromEntries(e.headers.entries()),base64Body:r},e=e.url}return syscall("sandboxFetch.fetch",e,t)}function D(){globalThis.nativeFetch=globalThis.fetch,globalThis.fetch=async function(e,t){let o=t&&t.body?y(new Uint8Array(await new Response(t.body).arrayBuffer())):void 0,r=await S(e,t&&{method:t.method,headers:t.headers,base64Body:o});return new Response(r.base64Body?I(r.base64Body):null,{status:r.status,headers:r.headers})}}D();var s={};p(s,{attachFile:()=>_,confirm:()=>Z,dispatch:()=>V,downloadFile:()=>N,filterBox:()=>Y,flashNotification:()=>q,fold:()=>ne,foldAll:()=>se,getCurrentPage:()=>k,getCursor:()=>U,getSelection:()=>E,getText:()=>T,getUiOption:()=>ee,hidePanel:()=>G,insertAtCursor:()=>Q,insertAtPos:()=>H,moveCursor:()=>K,navigate:()=>$,openUrl:()=>W,prompt:()=>X,reloadPage:()=>L,reloadUI:()=>j,replaceRange:()=>J,save:()=>O,setPage:()=>R,setSelection:()=>B,setUiOption:()=>te,showPanel:()=>z,toggleFold:()=>ie,unfold:()=>oe,unfoldAll:()=>ae,vimEx:()=>re});typeof self>"u"&&(self={syscall:()=>{throw new Error("Not implemented here")}});var n=self.syscall;function k(){return n("editor.getCurrentPage")}function R(e){return n("editor.setPage",e)}function T(){return n("editor.getText")}function U(){return n("editor.getCursor")}function E(){return n("editor.getSelection")}function B(e,t){return n("editor.setSelection",e,t)}function O(){return n("editor.save")}function $(e,t,o=!1,r=!1){return n("editor.navigate",e,t,o,r)}function L(){return n("editor.reloadPage")}function j(){return n("editor.reloadUI")}function W(e,t=!1){return n("editor.openUrl",e,t)}function N(e,t){return n("editor.downloadFile",e,t)}function _(e,t,o=null){return n("editor.attachFile",e,t,o)}function q(e,t="info"){return n("editor.flashNotification",e,t)}function Y(e,t,o="",r=""){return n("editor.filterBox",e,t,o,r)}function z(e,t,o,r=""){return n("editor.showPanel",e,t,o,r)}function G(e){return n("editor.hidePanel",e)}function H(e,t){return n("editor.insertAtPos",e,t)}function J(e,t,o){return n("editor.replaceRange",e,t,o)}function K(e,t=!1){return n("editor.moveCursor",e,t)}function Q(e){return n("editor.insertAtCursor",e)}function V(e){return n("editor.dispatch",e)}function X(e,t=""){return n("editor.prompt",e,t)}function Z(e){return n("editor.confirm",e)}function ee(e){return n("editor.getUiOption",e)}function te(e,t){return n("editor.setUiOption",e,t)}function re(e){return n("editor.vimEx",e)}function ne(){return n("editor.fold")}function oe(){return n("editor.unfold")}function ie(){return n("editor.toggleFold")}function se(){return n("editor.foldAll")}function ae(){return n("editor.unfoldAll")}function g(e){function t(o){let r=String(o);return r.length===1&&(r="0"+r),r}return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())}function h(e){let t=e.toISOString(),[o,r]=t.split("T");return r.split(".")[0]}async function P(){let e=await s.prompt("The name for the upload:",`images/camera/${g(new Date)}_${h(new Date)}.jpg`);e&&s.attachFile(e,"image/jpeg","environment")}async function x(){let e=await s.prompt("The name for the daily image:",`images/daily/${g(new Date)}.jpg`);e&&s.attachFile(e,"image/jpeg")}async function d(e=null){let t=await s.attachFile(null,"image/*",e);console.log(`Attached file: ${t}`);let o=await s.getCursor(),r=await s.getCurrentPage();await s.insertAtCursor(`![](${t})`)}async function v(){await d("environment")}var b={attachDailyImage:x,attachCameraImage:P,insertImage:d,insertCameraImage:v},he={name:"attach",functions:{attachDailyImage:{path:"attach.ts:attachDailyImage",command:{name:"Attach: Daily image"}},attachCameraImage:{path:"attach.ts:attachCameraImage",command:{name:"Attach: Camera Image"}},insertImage:{path:"attach.ts:insertImage",slashCommand:{name:"attach",description:"Attach an image"}},insertCameraImage:{path:"attach.ts:insertCameraImage",slashCommand:{name:"camera",description:"Attach an image from the device camera"}}},assets:{}};f(b,he);return M(Pe);})();
